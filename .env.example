# ===========================================
# WAYGATE ENVIRONMENT CONFIGURATION
# ===========================================
# Copy this file to .env.local and fill in your values.
# .env.local is gitignored and safe for secrets.
#
# ┌──────────────────────────────────────────────────────────┐
# │ ENVIRONMENT VARIABLE GUIDE                               │
# │                                                          │
# │ Build-time = needed during `next build` / CI             │
# │ Runtime    = needed when the server is running           │
# │ Client     = NEXT_PUBLIC_ prefixed, exposed to browser   │
# │                                                          │
# │ Environments: Dev = local, Preview = Vercel PR deploys,  │
# │               Production = live deployment               │
# └──────────────────────────────────────────────────────────┘

# ─────────────────────────────────────────
# SUPABASE (Database, Auth, Storage)
# ─────────────────────────────────────────
# Get these from: https://supabase.com/dashboard/project/YOUR_PROJECT/settings/api

# [Client | Runtime] Required in all environments
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key

# [Runtime] Required in all environments — server-side admin access (bypasses RLS)
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key

# [Build-time + Runtime] Required in all environments
# Format: postgresql://USER:PASSWORD@HOST:PORT/DATABASE
# Build: needed for `prisma generate` and `prisma migrate deploy`
# Runtime: needed for database queries
DATABASE_URL=postgresql://postgres:your-password@db.your-project.supabase.co:5432/postgres

# ─────────────────────────────────────────
# AI SERVICES
# ─────────────────────────────────────────

# [Runtime] Required — Google Gemini for AI doc scraping and analysis
# Get from: https://makersuite.google.com/app/apikey
GOOGLE_API_KEY=your-google-api-key

# [Runtime] Required if using Gemini for agentic tools (separate from GOOGLE_API_KEY)
# Get from: https://makersuite.google.com/app/apikey
GOOGLE_AI_API_KEY=your-google-ai-api-key

# [Runtime] Required if using Claude for agentic tools
# Get from: https://console.anthropic.com/
# ANTHROPIC_API_KEY=your-anthropic-api-key

# [Runtime] Required — Firecrawl for web scraping API documentation
# Get from: https://firecrawl.dev/
FIRECRAWL_API_KEY=your-firecrawl-api-key

# [Runtime] Optional — Override default LLM model (default: gemini-3-pro)
# LLM_DEFAULT_MODEL=gemini-3-pro

# ─────────────────────────────────────────
# SECURITY
# ─────────────────────────────────────────

# [Runtime] Required in all environments — 32-byte hex string (64 hex characters)
# Used for AES-256-GCM encryption of integration credentials
# Generate with: openssl rand -hex 32
ENCRYPTION_KEY=your-64-character-hex-string

# ─────────────────────────────────────────
# APPLICATION
# ─────────────────────────────────────────

# [Client | Runtime] Required in all environments
# Used for OAuth redirect URIs and link generation
# Dev: http://localhost:3000
# Preview: Set automatically by Vercel (https://<deployment>.vercel.app)
# Production: https://your-production-domain.com
NEXT_PUBLIC_APP_URL=http://localhost:3000

# [Client | Runtime] Optional — API base URL for exported tool configurations
# Default: https://api.waygate.ai
# NEXT_PUBLIC_API_BASE_URL=https://api.waygate.ai

# [Runtime] Set automatically by Next.js — do not set manually in production
NODE_ENV=development

# [Runtime] Optional — Primary environment identifier (overrides NODE_ENV for Waygate-specific logic)
# Values: development | preview | production
# WAYGATE_ENVIRONMENT=development

# ─────────────────────────────────────────
# CRON & INTERNAL ENDPOINTS
# ─────────────────────────────────────────

# [Runtime] Required in production — Vercel auto-injects this for cron job authorization
# In dev, endpoints allow unauthenticated requests when this is not set
# Generate with: openssl rand -hex 32
CRON_SECRET=your-cron-secret

# ─────────────────────────────────────────
# TOOL EXPORTS & GATEWAY
# ─────────────────────────────────────────

# [Runtime] Required for tool export features (MCP, LangChain, Universal)
# This is the tenant's Waygate API key used in exported tool configurations
# WAYGATE_API_KEY=your-waygate-api-key

# ─────────────────────────────────────────
# DEVELOPMENT ONLY
# ─────────────────────────────────────────

# [Client | Runtime] Dev only — API key for client-side testing (ActionTester, API client)
# DO NOT set in production — this is exposed to the browser
# NEXT_PUBLIC_DEV_API_KEY=your-dev-api-key

# ─────────────────────────────────────────
# OPTIONAL SERVICES (V1+)
# ─────────────────────────────────────────

# [Runtime] Upstash Redis for caching
# UPSTASH_REDIS_REST_URL=https://xxx.upstash.io
# UPSTASH_REDIS_REST_TOKEN=xxx

# [Runtime] Trigger.dev for background jobs
# TRIGGER_API_KEY=xxx

# [Runtime] Resend for transactional email
# RESEND_API_KEY=xxx

# ─────────────────────────────────────────
# DATABASE MIGRATION WORKFLOW
# ─────────────────────────────────────────
#
# Local development:
#   Use `prisma db push` to sync schema → DB without creating migration files.
#   This is fast and avoids reset prompts during active development.
#
# Creating migrations (before merging to main):
#   Run `prisma migrate dev --name <description>` to create a migration file
#   from your schema changes. This generates SQL in prisma/migrations/.
#
# Production (Vercel):
#   The build command runs `prisma migrate deploy` automatically.
#   This applies any pending migration files to the production database.
#   It does NOT generate new migrations — it only applies existing ones.
#
# Existing dev databases (after pulling new migrations):
#   If a migration was already applied via `db push`, mark it as applied:
#     npx prisma migrate resolve --applied <migration_name>
#   Example:
#     npx prisma migrate resolve --applied 20260201000000_add_apps_agentic_pipelines_drift
